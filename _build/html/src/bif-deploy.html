

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gbif单节点部署文档 &mdash; bid-document 1.0.1 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.0.1',
              LANGUAGE:'zh_CN',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> bid-document
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Gbif单节点部署文档</a><ul>
<li><a class="reference internal" href="#id1">单机部署gbif节点大致分为几个步骤：</a></li>
<li><a class="reference internal" href="#id2">推荐服务器</a></li>
<li><a class="reference internal" href="#id3">节点安装流程</a><ul>
<li><a class="reference internal" href="#go">1. 配置go运行环境：</a></li>
<li><a class="reference internal" href="#id4">下载go包</a></li>
<li><a class="reference internal" href="#go-bashrc">2. 配置go环境变量，在~/.bashrc中添加配置</a></li>
<li><a class="reference internal" href="#go-bif-gbif">3. 配置go-bif源码,执行完成后，会在项目根目录生成gbif客执行文件</a></li>
<li><a class="reference internal" href="#genesis-json">4. 配置genesis.json文件</a></li>
<li><a class="reference internal" href="#id5">5. 初始化gbif</a></li>
<li><a class="reference internal" href="#id6">6. 启动节点</a><ul>
<li><a class="reference internal" href="#id7">7. 启动后会看到如下输出：</a></li>
<li><a class="reference internal" href="#id8">8. 配置挖矿账号</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">此时，节点已经启动好，只需等待它自动加入到主网中</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id10">Gbif本地私有链部署</a><ul>
<li><a class="reference internal" href="#witnesses">自己生成witnesses</a></li>
<li><a class="reference internal" href="#config-toml-extradata">编写config.toml， 生成extraData</a></li>
<li><a class="reference internal" href="#alloc">配置alloc</a></li>
<li><a class="reference internal" href="#id11">最终组合成的genesis.json格式如下</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">bid-document</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Gbif单节点部署文档</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/src/bif-deploy.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gbif">
<h1>Gbif单节点部署文档<a class="headerlink" href="#gbif" title="永久链接至标题">¶</a></h1>
<div class="section" id="id1">
<h2>单机部署gbif节点大致分为几个步骤：<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>配置好go运行环境，推荐使用CentOS7</li>
<li>配置gbif源码，本地编译通过</li>
<li>执行gbif初始化操作</li>
<li>启动gbif节点</li>
<li>创建一个并且解锁账号，用于挖矿</li>
</ul>
</div>
<div class="section" id="id2">
<h2>推荐服务器<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>CentOS7</li>
<li>4核</li>
<li>16G</li>
<li>50G</li>
</ul>
</div>
<div class="section" id="id3">
<h2>节点安装流程<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<div class="section" id="go">
<h3>1. 配置go运行环境：<a class="headerlink" href="#go" title="永久链接至标题">¶</a></h3>
</div>
<div class="section" id="id4">
<h3>下载go包<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell"><div class="highlight"><pre><span></span> wget https://dl.google.com/go/go1.13.5.linux-amd64.tar.gz
 tar -C /usr/local -xzf go1.13.5.linux-amd64.tar.gz
</pre></div>
</div>
</div>
<div class="section" id="go-bashrc">
<h3>2. 配置go环境变量，在~/.bashrc中添加配置<a class="headerlink" href="#go-bashrc" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell"><div class="highlight"><pre><span></span>vim ~/.bashrc
//添加到最后
<span class="nb">export</span> <span class="nv">GOROOT</span><span class="o">=</span>/usr/local/go
<span class="nb">export</span> <span class="nv">GOPATH</span><span class="o">=</span><span class="nv">$HOME</span>/code
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$GOPATH</span>/bin:<span class="nv">$GOROOT</span>/bin:<span class="nv">$PATH</span>
<span class="nb">export</span> <span class="nv">GO111MODULE</span><span class="o">=</span>off

<span class="nb">source</span> ~/.bashrc

go version //输出 go version go1.13.5 linux/amd64，代表安装成功
</pre></div>
</div>
</div>
<div class="section" id="go-bif-gbif">
<h3>3. 配置go-bif源码,执行完成后，会在项目根目录生成gbif客执行文件<a class="headerlink" href="#go-bif-gbif" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell"><div class="highlight"><pre><span></span>mkdir -p <span class="nv">$HOME</span>/code/src/github.com/bif
<span class="nb">cd</span> <span class="nv">$HOME</span>/code/src/github.com/bif
git clone http://192.168.150.43:8080/BIF/go-bif.git
<span class="nb">cd</span> go-bif
go build github.com/bif/go-bif/cmd/gbif
</pre></div>
</div>
</div>
<div class="section" id="genesis-json">
<h3>4. 配置genesis.json文件<a class="headerlink" href="#genesis-json" title="永久链接至标题">¶</a></h3>
<p>在项目跟目录下添加genesis.json文件，文件内容如下：</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;chainId&quot;</span><span class="p">:</span> <span class="mi">444</span><span class="p">,</span>
    <span class="nt">&quot;constantinopleBlock&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;dpos&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;period&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nt">&quot;witnessesNum&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="nt">&quot;witnesses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;</span><span class="p">,</span>
          <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;enode://862d66d1255c7ac9c6d86920081069a4d7c295c838140217644ac6f4fcddd0d2edef63951148affb107223fbd1331363e275125bc0cfeb34b1daad26328f8b20@127.0.0.1:44001?discport=0&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:c935bd29a90fbeea87badf3e&quot;</span><span class="p">,</span>
          <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;enode://0d843e75752ca5c7db12c2e8e2dc4e6eb771ddf1511809c4e708bc74abad0f14f970229a64287ec34122d3657167ea7dd5c9f1902ca6fcfc0b0a91e78d39573c@127.0.0.1:44011?discport=0&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:13803fb30b7e95d57103c2dc&quot;</span><span class="p">,</span>
          <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;enode://7e42b87fda19dfe6b4a8e425d882c60a43667a3d731aabd19ad9aa3cdb98f0cc76c2664cb12b1a39c2c2e848afc6262a73a800cd845af10de1e90766628b2cc8@127.0.0.1:44021?discport=0&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;nonce&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;0x5d131141&quot;</span><span class="p">,</span>
  <span class="nt">&quot;extraData&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0000000000000000000000000000000000000000000000000000000000000000f885f83f946469643a6269643a6cc796b8d6e2fbebc9b3cf9e946469643a6269643ac935bd29a90fbeea87badf3e946469643a6269643a13803fb30b7e95d57103c2dcb8410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;gasLimit&quot;</span><span class="p">:</span> <span class="s2">&quot;0x47b760&quot;</span><span class="p">,</span>
  <span class="nt">&quot;difficulty&quot;</span><span class="p">:</span> <span class="s2">&quot;0x1&quot;</span><span class="p">,</span>
  <span class="nt">&quot;mixHash&quot;</span><span class="p">:</span> <span class="s2">&quot;0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365&quot;</span><span class="p">,</span>
  <span class="nt">&quot;coinbase&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:000000000000000000000000&quot;</span><span class="p">,</span>
  <span class="nt">&quot;alloc&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;balance&quot;</span><span class="p">:</span> <span class="s2">&quot;0x446c3b15f9926687d2c40534fdb564000000000000&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;number&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;gasUsed&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;parentHash&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>5. 初始化gbif<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell"><div class="highlight"><pre><span></span>./gbif init genesis.json --datadir ./data
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>6. 启动节点<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell"><div class="highlight"><pre><span></span>./gbif --networkid <span class="m">444</span> --datadir ./data --verbosity <span class="m">4</span> --port <span class="m">44001</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44002</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44003</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console
</pre></div>
</div>
<ul class="simple">
<li>networkid： gbif网络号，要和genesis.json里面的一致</li>
<li>--verbosity： 日志等级</li>
<li>--rpcport： rpc端口号</li>
<li>--rpcapi： 根据需要选择开放的rpc类型</li>
<li>--wsapi： 根据需要选择开放websocket api类型</li>
<li>--wsport： websocket端口号</li>
<li>console： 添加console后，节点启动后将自动进入控制台(gbif console)界面</li>
</ul>
<div class="section" id="id7">
<h4>7. 启动后会看到如下输出：<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h4>
<div class="highlight-shell"><div class="highlight"><pre><span></span>Welcome to the Gbif JavaScript console!

instance: Gbif/v1.9.0-unstable/darwin-amd64/go1.13.5
at block: <span class="m">0</span> <span class="o">(</span>Wed, <span class="m">26</span> Jun <span class="m">2019</span> <span class="m">14</span>:31:29 CST<span class="o">)</span>
 datadir: /home/teleinfo/code/src/github.com/bif/go-bif/data/
 modules: admin:1.0 bif:1.0 core:1.0 debug:1.0 dpos:1.0 gb:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0

&gt; 
&gt; 
&gt;
</pre></div>
</div>
<p>此时我们已成功启动节点，并且已进入到控制台界面</p>
</div>
<div class="section" id="id8">
<h4>8. 配置挖矿账号<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h4>
<p>在刚刚出现的控制台中输入, teleinfo 为您的账号密码，可以随意定制，还请记录好：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>personal.newAccount<span class="o">(</span><span class="s2">&quot;teleinfo&quot;</span><span class="o">)</span>
personal.unlockAccount<span class="o">(</span>core.accounts<span class="o">[</span><span class="m">0</span><span class="o">]</span>, <span class="s2">&quot;teleinfo&quot;</span><span class="o">)</span>
core.accounts<span class="o">[</span><span class="m">0</span><span class="o">]</span> //查看刚刚生成的地址
admin.nodeInfo.enode //查看enode 
miner.start<span class="o">()</span>
</pre></div>
</div>
<p>此时，在data/keystore下会有一个文件名为： UTC--2019-12-16T11-18-04.703989000Z--did-bid-6cc796b8d6e2fbebc9b3cf9e 这种格式的文件，此文件即为您的keystore，文件名最后面为地址
enode格式为: &quot;enode://4b87eed1cbb9c85abf94f784daa63ed4358726f5fefe702fea77cbce1a53813b68139f02779c493f87b3566b34cf35a5bf2963dcad8b5fee00f4be741b56f864&#64;127.0.0.1:44031&quot;</p>
</div>
</div>
<div class="section" id="id9">
<h3>此时，节点已经启动好，只需等待它自动加入到主网中<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
</div>
</div>
</div>
<div class="section" id="id10">
<h1>Gbif本地私有链部署<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h1>
<p>本地私有链是在本地电脑上部署出一整套完成的gbif的节点，这里以四个节点组成一条链为例：</p>
<ul class="simple">
<li>三个超级节点</li>
<li>一个普通节点</li>
</ul>
<p>超级节点和普通节点配置时候的区别在于genesis.json中&quot;witnesses&quot;和&quot;extraData&quot;字段中是否包含当前节点的address和enode，而启动自己的私有链的第一步就是生成自己的genesis.json. 我们先拿到一个genesis.json的模板：</p>
<div class="highlight-json"><div class="highlight"><pre><span></span>{
  &quot;config&quot;: {
    &quot;chainId&quot;: 444,
    &quot;constantinopleBlock&quot;: 1,
    &quot;dpos&quot;: {
      &quot;period&quot;: 2, //出块时间,单位为秒
      &quot;witnessesNum&quot;: 3, //见证人数量，这里是以4个几点为例，根据3m+1规则,3个即为dpos的最小数量了，所以这里设定为3
      &quot;witnesses&quot;: [
          //TODO
      ]
    }
  },
  &quot;nonce&quot;: &quot;0x0&quot;,
  &quot;timestamp&quot;: &quot;0x5d131141&quot;,
  &quot;extraData&quot;:  //TODO,
  &quot;gasLimit&quot;: &quot;0x47b760&quot;,
  &quot;difficulty&quot;: &quot;0x1&quot;,
  &quot;mixHash&quot;: &quot;0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365&quot;,
  &quot;coinbase&quot;: &quot;did:bid:000000000000000000000000&quot;,
  &quot;alloc&quot;: {
    //TODO
  },
  &quot;number&quot;: &quot;0x0&quot;,
  &quot;gasUsed&quot;: &quot;0x0&quot;,
  &quot;parentHash&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;
}
</pre></div>
</div>
<p>上面标出//TODO的地方即为我们需要自己生成的部分，可以看到有三处</p>
<div class="section" id="witnesses">
<h2>自己生成witnesses<a class="headerlink" href="#witnesses" title="永久链接至标题">¶</a></h2>
<p>按照上面单节点的部署流程，我们在走到第3步之后，直接执行第6步，即可以拿到节点的address和enode
需要注意的是，启动的时候datadir和端口号需要修改一下，启动三个命令行窗口，都cd 到项目录，然后分别执行下面的命令</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>//命令行窗口1
./gbif --networkid <span class="m">444</span> --datadir ./data/node0 --verbosity <span class="m">4</span> --port <span class="m">44001</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44002</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44003</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console

//命令行窗口2
./gbif --networkid <span class="m">444</span> --datadir ./data/node1 --verbosity <span class="m">4</span> --port <span class="m">44011</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44012</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44013</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console

//命令行窗口3
./gbif --networkid <span class="m">444</span> --datadir ./data/node2 --verbosity <span class="m">4</span> --port <span class="m">44021</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44022</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44023</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console
</pre></div>
</div>
<p>然后按照上面第6步的方法，分别拿到各自的address和enode，按照下面的格式添加到genesis.json, &quot;witenesses&quot;节点下：</p>
<div class="highlight-json"><div class="highlight"><pre><span></span>    {
        &quot;address&quot;: &quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;, //命令行窗口1拿到的address
        &quot;url&quot;: &quot;enode://862d66d1255c7ac9c6d86920081069a4d7c295c838140217644ac6f4fcddd0d2edef63951148affb107223fbd1331363e275125bc0cfeb34b1daad26328f8b20@127.0.0.1:44001?discport=0&quot; //命令行窗口1拿到的enode
    },
    {
        &quot;address&quot;: &quot;did:bid:c935bd29a90fbeea87badf3e&quot;, //命令行窗口2拿到的address
        &quot;url&quot;: &quot;enode://0d843e75752ca5c7db12c2e8e2dc4e6eb771ddf1511809c4e708bc74abad0f14f970229a64287ec34122d3657167ea7dd5c9f1902ca6fcfc0b0a91e78d39573c@127.0.0.1:44011?discport=0&quot; //命令行窗口2拿到的enode
    },
    {
        &quot;address&quot;: &quot;did:bid:13803fb30b7e95d57103c2dc&quot;, //命令行窗口3拿到的address
        &quot;url&quot;: &quot;enode://7e42b87fda19dfe6b4a8e425d882c60a43667a3d731aabd19ad9aa3cdb98f0cc76c2664cb12b1a39c2c2e848afc6262a73a800cd845af10de1e90766628b2cc8@127.0.0.1:44021?discport=0&quot; //命令行窗口3拿到的enode
    }
</pre></div>
</div>
</div>
<div class="section" id="config-toml-extradata">
<h2>编写config.toml， 生成extraData<a class="headerlink" href="#config-toml-extradata" title="永久链接至标题">¶</a></h2>
<div class="highlight-shell"><div class="highlight"><pre><span></span>//当前目录为项目根目录
vim config.toml

//向文件中写入<span class="o">(</span>这三个地址依次的上面三个节点的地址<span class="o">)</span>：
<span class="nv">vanity</span> <span class="o">=</span> <span class="s2">&quot;0x00&quot;</span>
<span class="nv">validators</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;</span>,<span class="s2">&quot;did:bid:c935bd29a90fbeea87badf3e&quot;</span>,<span class="s2">&quot;did:bid:13803fb30b7e95d57103c2dc&quot;</span><span class="o">]</span>
</pre></div>
</div>
<p>生成extraData：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>./gbif extra encode --config ./config.toml
//生成的结果为如下格式：
//Encoded Istanbul extra-data: 0x0000000000000000000000000000000000000000000000000000000000000000f885f83f946469643a6269643a6cc796b8d6e2fbebc9b3cf9e946469643a6269643ac935bd29a90fbeea87badf3e946469643a6269643a13803fb30b7e95d57103c2dcb8410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0
</pre></div>
</div>
<p>将0x00000000...00000c0 一长串放入到genesis.json的&quot;extraData&quot;中</p>
</div>
<div class="section" id="alloc">
<h2>配置alloc<a class="headerlink" href="#alloc" title="永久链接至标题">¶</a></h2>
<p>alloc 即为链启动后创世产生的token，这里配置多少地址和对应的token，链产生后，这些地址上就会有相应多的token，填写格式如下：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>    <span class="s2">&quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;</span>: <span class="o">{</span> //要创世时发配token的地址
      <span class="s2">&quot;balance&quot;</span>: <span class="s2">&quot;0x446c3b15f9926687d2c40534fdb564000000000000&quot;</span> //设定这个地址是多少钱
    <span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h2>最终组合成的genesis.json格式如下<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h2>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;chainId&quot;</span><span class="p">:</span> <span class="mi">444</span><span class="p">,</span>
    <span class="nt">&quot;constantinopleBlock&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;dpos&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;period&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="nt">&quot;witnessesNum&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="nt">&quot;witnesses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;</span><span class="p">,</span>
          <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;enode://862d66d1255c7ac9c6d86920081069a4d7c295c838140217644ac6f4fcddd0d2edef63951148affb107223fbd1331363e275125bc0cfeb34b1daad26328f8b20@127.0.0.1:44001?discport=0&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:c935bd29a90fbeea87badf3e&quot;</span><span class="p">,</span>
          <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;enode://0d843e75752ca5c7db12c2e8e2dc4e6eb771ddf1511809c4e708bc74abad0f14f970229a64287ec34122d3657167ea7dd5c9f1902ca6fcfc0b0a91e78d39573c@127.0.0.1:44011?discport=0&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:13803fb30b7e95d57103c2dc&quot;</span><span class="p">,</span>
          <span class="nt">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;enode://7e42b87fda19dfe6b4a8e425d882c60a43667a3d731aabd19ad9aa3cdb98f0cc76c2664cb12b1a39c2c2e848afc6262a73a800cd845af10de1e90766628b2cc8@127.0.0.1:44021?discport=0&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;nonce&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;0x5d131141&quot;</span><span class="p">,</span>
  <span class="nt">&quot;extraData&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0000000000000000000000000000000000000000000000000000000000000000f885f83f946469643a6269643a6cc796b8d6e2fbebc9b3cf9e946469643a6269643ac935bd29a90fbeea87badf3e946469643a6269643a13803fb30b7e95d57103c2dcb8410000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;gasLimit&quot;</span><span class="p">:</span> <span class="s2">&quot;0x47b760&quot;</span><span class="p">,</span>
  <span class="nt">&quot;difficulty&quot;</span><span class="p">:</span> <span class="s2">&quot;0x1&quot;</span><span class="p">,</span>
  <span class="nt">&quot;mixHash&quot;</span><span class="p">:</span> <span class="s2">&quot;0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365&quot;</span><span class="p">,</span>
  <span class="nt">&quot;coinbase&quot;</span><span class="p">:</span> <span class="s2">&quot;did:bid:000000000000000000000000&quot;</span><span class="p">,</span>
  <span class="nt">&quot;alloc&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;did:bid:6cc796b8d6e2fbebc9b3cf9e&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;balance&quot;</span><span class="p">:</span> <span class="s2">&quot;0x446c3b15f9926687d2c40534fdb564000000000000&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;number&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;gasUsed&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;parentHash&quot;</span><span class="p">:</span> <span class="s2">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>此时退出上面启动的三个超级节点(在gbif console 中输入exit即可退出)，将新配置出来的genesis.json放到项目根目录下，分别打开四个命令行窗口</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>//窗口一：
<span class="nb">cd</span> <span class="nv">$HOME</span>/code/src/github.com/bif/go-bif
rm -rf data/node0/gbif
./gbif init genesis.json --datadir ./data/node0
./gbif --networkid <span class="m">444</span> --datadir ./data/node0 --verbosity <span class="m">4</span> --port <span class="m">44001</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44002</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44003</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console

//进入gbif console之后执行：
personal.unlockAccount<span class="o">(</span>core.accounts<span class="o">[</span><span class="m">0</span><span class="o">]</span>, <span class="s2">&quot;teleinfo&quot;</span><span class="o">)</span>
miner.start<span class="o">()</span>

//窗口二：
<span class="nb">cd</span> <span class="nv">$HOME</span>/code/src/github.com/bif/go-bif
rm -rf data/node1/gbif
./gbif init genesis.json --datadir ./data/node1
./gbif --networkid <span class="m">444</span> --datadir ./data/node1 --verbosity <span class="m">4</span> --port <span class="m">44011</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44012</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44013</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console

//进入gbif console之后执行：
personal.unlockAccount<span class="o">(</span>core.accounts<span class="o">[</span><span class="m">0</span><span class="o">]</span>, <span class="s2">&quot;teleinfo&quot;</span><span class="o">)</span>
miner.start<span class="o">()</span>

//窗口三：
<span class="nb">cd</span> <span class="nv">$HOME</span>/code/src/github.com/bif/go-bif
rm -rf data/node2/gbif
./gbif init genesis.json --datadir ./data/node2
./gbif --networkid <span class="m">444</span> --datadir ./data/node2 --verbosity <span class="m">4</span> --port <span class="m">44021</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44022</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44023</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console

//进入gbif console之后执行：
personal.unlockAccount<span class="o">(</span>core.accounts<span class="o">[</span><span class="m">0</span><span class="o">]</span>, <span class="s2">&quot;teleinfo&quot;</span><span class="o">)</span>
miner.start<span class="o">()</span>

//窗口四：
<span class="nb">cd</span> <span class="nv">$HOME</span>/code/src/github.com/bif/go-bif
./gbif init genesis.json --datadir ./data/node3
./gbif --networkid <span class="m">444</span> --datadir ./data/node3 --verbosity <span class="m">4</span> --port <span class="m">44031</span> --rpc --rpcaddr <span class="m">0</span>.0.0.0 --rpcport <span class="m">44032</span> --rpcapi core,gb,admin,personal,db,net,txpool,bif --ws --wsaddr <span class="m">0</span>.0.0.0 --wsport <span class="m">44033</span> --wsapi core,gb,admin,personal,db,net,txpool --rpccorsdomain <span class="s1">&#39;*&#39;</span> console

//进入gbif console之后执行：
personal.unlockAccount<span class="o">(</span>core.accounts<span class="o">[</span><span class="m">0</span><span class="o">]</span>, <span class="s2">&quot;teleinfo&quot;</span><span class="o">)</span>
miner.start<span class="o">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, teleinfo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>